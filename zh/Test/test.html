<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>API æ¸¬è©¦æ§åˆ¶å°ï½œKAO-YU-HSIANG</title>

  <!-- å…±ç”¨æ¨£å¼ -->
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- å¤–éƒ¨å¥—ä»¶ -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    /* ğŸŸ© çµ±ä¸€æ‰€æœ‰æŒ‰éˆ•æ¨£å¼ */
    button.btn {
      font-size: 1.05rem;
      background-color: #198754 !important;
      color: white !important;
      border: none !important;
    }
    button.btn:hover {
      background-color: #157347 !important;
      color: #fff !important;
    }
  </style>
</head>

<body>
  <div id="header"></div>

  <main id="main" class="container">
    <div class="text-center mb-5">
      <h1>ğŸ§ª API æ¸¬è©¦æ§åˆ¶å°</h1>
      <p class="text-muted">å¿«é€Ÿæ¸¬è©¦ Lambdaã€EC2ã€CloudFront API çš„å›å‚³çµæœã€‚</p>
    </div>

    <!-- ğŸ”‘ 0. ä½¿ç”¨è€…é‡‘é‘°è¨­å®š -->
    <div class="section-title">ğŸ”‘ 0. ä½¿ç”¨è€…é‡‘é‘°è¨­å®š</div>
    <div class="card p-3 mb-4 shadow-sm bg-white border-0">
      <div class="mb-2">
        <label for="apiKeyInput" class="form-label fw-bold text-dark">
          è«‹è¼¸å…¥æ‚¨çš„ API é‡‘é‘°ï¼š
        </label>
        <input type="text" id="apiKeyInput" class="form-control fw-bold text-dark"
              placeholder="ä¾‹å¦‚ï¼šè«‹åˆ° index.html ç™»å…¥å¸³è™Ÿå¯†ç¢¼å¾Œè‡ªå‹•å¸¶å…¥ API Key">
      </div>

      <div class="d-flex flex-wrap gap-2">
        <button id="saveKeyBtn" class="btn btn-success fw-bold">ğŸ’¾ å„²å­˜é‡‘é‘°</button>
        <button id="clearKeyBtn" class="btn btn-outline-danger fw-bold">ğŸ§¹ æ¸…é™¤é‡‘é‘°</button>
      </div>

      <p class="mt-3 fw-bold text-secondary">
        å„²å­˜å¾Œæœƒè‡ªå‹•ä¿å­˜åœ¨ç€è¦½å™¨ï¼ˆlocalStorageï¼‰ã€‚æ‰€æœ‰ API å‘¼å«éƒ½æœƒè‡ªå‹•å¤¾å¸¶æ­¤é‡‘é‘°ã€‚
      </p>

      <div class="mt-2 border-top pt-2">
        <b class="fw-bold text-dark">ç›®å‰é‡‘é‘°ï¼š</b>
        <span id="currentKeyDisplay" class="fw-bold text-success">
          ï¼ˆå°šæœªè¨­å®šï¼‰
        </span>
      </div>
    </div>

    <!-- âš™ï¸ ä¸€ã€Lambda API æ¸¬è©¦ -->
    <div class="section-title">âš™ï¸ ä¸€ã€Lambda API æ¸¬è©¦</div>
    <pre><code>
https://4b5cqz0xpd.execute-api.ap-northeast-1.amazonaws.com/Prod/hello
https://4b5cqz0xpd.execute-api.ap-northeast-1.amazonaws.com/Prod/test
    </code></pre>

    <div class="d-flex flex-wrap gap-2">
      <button id="btnHello" class="btn">
        ğŸš€ å‘¼å« /hello
      </button>
      <button id="btnTest" class="btn">
        ğŸš€ å‘¼å« /test
      </button>
    </div>

    <div id="helloResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /hello</div>
    <div id="testResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /test</div>

    <!-- ğŸŒ äºŒã€å…¬å…± API æ¸¬è©¦ -->
    <div class="section-title">ğŸŒ äºŒã€å…¬å…± API æ¸¬è©¦</div>
    <pre><code>https://jsonplaceholder.typicode.com/todos/1</code></pre>

    <button id="btnPublic" class="btn">ğŸš€ å‘¼å«å…¬å…± API</button>
    <div id="publicResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦</div>

    <!-- âš¡ ä¸‰ã€EC2 Flask æ¸¬è©¦ -->
    <div class="section-title">âš¡ ä¸‰ã€EC2 Flask API æ¸¬è©¦</div>
    <pre><code>http://18.176.60.86:5000/</code></pre>

    <button id="btnEC2" class="btn">ğŸš€ å‘¼å« EC2 Flask API</button>
    <div id="ec2Result" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ EC2 Flask</div>

    <!-- ğŸ§© å››ã€EC2 Gunicorn + Nginx æ¸¬è©¦ -->
    <div class="section-title">ğŸ§© å››ã€EC2 Gunicorn + Nginx æ¸¬è©¦</div>
    <pre><code>
http://18.176.60.86/
http://18.176.60.86/status
http://18.176.60.86/api/
http://18.176.60.86/api/status
    </code></pre>

    <div class="d-flex flex-wrap gap-2">
      <button id="btnGunicornRoot" class="btn">ğŸš€ å‘¼å« /</button>
      <button id="btnGunicornStatus" class="btn">ğŸš€ å‘¼å« /status</button>
      <button id="btnGunicornAPI" class="btn">ğŸš€ å‘¼å« /api/</button>
      <button id="btnGunicornAPIStatus" class="btn">ğŸš€ å‘¼å« /api/status</button>
    </div>

    <div id="gunicornRootResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /</div>
    <div id="gunicornStatusResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /status</div>
    <div id="gunicornAPIResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /api/</div>
    <div id="gunicornAPIStatusResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ /api/status</div>

    <!-- â˜ï¸ äº”ã€CloudFront HTTPS Proxy æ¸¬è©¦ -->
    <div class="section-title">â˜ï¸ äº”ã€CloudFront HTTPS Proxy æ¸¬è©¦</div>
    <pre><code>
https://d2kenp4ywj2ej.cloudfront.net/api/
https://d2kenp4ywj2ej.cloudfront.net/api/status
    </code></pre>

    <div class="d-flex flex-wrap gap-2">
      <button id="btnCloudfrontAPI" class="btn">ğŸš€ å‘¼å« CloudFront /api/</button>
      <button id="btnCloudfrontStatus" class="btn">ğŸš€ å‘¼å« CloudFront /api/status</button>
    </div>

    <div id="cloudfrontAPIResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ CloudFront /api/</div>
    <div id="cloudfrontStatusResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ CloudFront /api/status</div>

    <!-- ğŸ” å…­ã€èº«åˆ†èªè­‰æ¸¬è©¦ï¼ˆCloudFront /api/loginï¼‰ -->
    <div class="section-title">ğŸ” å…­ã€èº«åˆ†èªè­‰æ¸¬è©¦ï¼ˆCloudFront /api/loginï¼‰</div>

    <!-- âœ… æ¸¬è©¦é€šé“èªªæ˜ -->
    <pre><code>
    ğŸŒ CloudFront Proxyï¼ˆæ­£å¼ HTTPS é€šé“ï¼‰ï¼š
    https://d2kenp4ywj2ej.cloudfront.net/api/login

    ğŸ§© EC2 Public IPï¼ˆé–‹ç™¼æ¸¬è©¦é€šé“ï¼‰ï¼š
    http://18.176.60.86/api/login

    âš ï¸ ç„¡æ³•ä½¿ç”¨ï¼ˆå°é–å…§éƒ¨åŸ ï¼‰ï¼š
    âŒ http://18.176.60.86:5001/login
    âŒ http://18.176.60.86:5001/api/login
    </code></pre>

    <!-- ğŸ§­ ç™»å…¥æ¸¬è©¦è¡¨å–®ï¼ˆç™½åº•ï¼‰ -->
    <div class="card p-3 mb-3 shadow-sm bg-white border-0">
      <div class="mb-2">
        <label for="loginUser" class="form-label fw-bold">å¸³è™Ÿï¼š</label>
        <input type="text" id="loginUser" class="form-control" placeholder="è¼¸å…¥å¸³è™Ÿ">
      </div>
      <div class="mb-2">
        <label for="loginPass" class="form-label fw-bold">å¯†ç¢¼ï¼š</label>
        <input type="password" id="loginPass" class="form-control" placeholder="è¼¸å…¥å¯†ç¢¼">
      </div>
      <button id="btnLoginTest" class="btn w-100">ğŸš€ ç™¼é€ç™»å…¥è«‹æ±‚</button>
    </div>

    <div id="loginResult" class="result-block mt-3">ğŸ•“ å°šæœªæ¸¬è©¦ç™»å…¥ API</div>

    <!-- ğŸ“˜ ç™»å…¥æ¶æ§‹ç­†è¨˜ï¼ˆèˆ‡å‰é¢æ ¼å¼ä¸€è‡´ï¼šæ·±åº•ï¼‹äº®å­—ï¼‰ -->
    <div class="mt-4 p-3 rounded" style="background:#2b2b2b; color:#e9ecef;">
      <h5 class="fw-bold text-info mb-3">ğŸ§¾ è£œå……ç­†è¨˜ï¼šç™»å…¥è·¯ç”±èˆ‡é€šé“é‚è¼¯</h5>

      <p class="fw-bold text-light mb-1">âœ… æ¸¬è©¦é …ç›®èˆ‡çµæœï¼š</p>
      <table class="table table-sm table-bordered align-middle" style="color:#f8f9fa; background:#3b3b3b; border-color:#6c757d;">
        <thead class="text-center" style="background:#495057;">
          <tr><th>æ¸¬è©¦é …ç›®</th><th>çµæœ</th><th>åŸå› </th></tr>
        </thead>
        <tbody>
          <tr><td>https://d2kenp4ywj2ej.cloudfront.net/api/login</td><td>âœ… æˆåŠŸ</td><td>CloudFront HTTPS é€šé“ä»£ç†è‡³ EC2 Nginxã€‚</td></tr>
          <tr><td>http://18.176.60.86/api/login</td><td>âœ… æˆåŠŸ</td><td>EC2 Nginx å°å¤–è½‰ç™¼è‡³å…§éƒ¨ Gunicorn (127.0.0.1:5001)ã€‚</td></tr>
          <tr><td>http://18.176.60.86:5001/login</td><td>âŒ å¤±æ•—</td><td>Gunicorn åƒ…é–‹æ”¾æœ¬æ©Ÿï¼Œå¤–éƒ¨å°é–æ­¤åŸ ã€‚</td></tr>
          <tr><td>http://18.176.60.86:5001/api/login</td><td>âŒ å¤±æ•—</td><td>åŒä¸Šï¼Œå¤–ç¶²ç„¡æ³•é€£æ¥å…§éƒ¨æœå‹™ã€‚</td></tr>
        </tbody>
      </table>

      <p class="fw-bold mt-3 mb-1 text-light">ğŸ§  ç‚ºä½•å¸¶ <code>:5001</code> æœƒå¤±æ•—ï¼š</p>
      <pre class="p-2 rounded" style="background:#1f1f1f; color:#e9ecef; border:1px solid #444;"><code>gunicorn -w 2 -b 127.0.0.1:5001 app_gunicorn:app</code></pre>

      <p class="text-light mb-2">
        å›  Gunicorn åƒ…ç›£è½ <b>127.0.0.1</b>ï¼ˆå…§éƒ¨å›ç’°ä½å€ï¼‰ï¼Œå¤–éƒ¨è«‹æ±‚æœƒè¢«é˜²ç«ç‰†èˆ‡ Nginx æ””æˆªã€‚  
        ç›®å‰ Nginx çš„è½‰ç™¼è¨­å®šå¦‚ä¸‹ï¼š
      </p>

      <pre class="p-2 rounded" style="background:#1f1f1f; color:#e9ecef; border:1px solid #444;"><code>80  â†’  127.0.0.1:5001
    443 â†’  127.0.0.1:5001</code></pre>

      <p class="fw-bold text-light mb-1">å› æ­¤å¤–éƒ¨å¿…é ˆé€éï¼š</p>
      <ul class="mb-3" style="color:#e9ecef;">
        <li>ğŸŒ <b>CloudFrontï¼ˆHTTPSï¼‰</b> â€” æ­£å¼éƒ¨ç½²å…¥å£</li>
        <li>ğŸ§© <b>EC2 å…¬ç¶² IPï¼ˆHTTPï¼‰</b> â€” é–‹ç™¼æ¸¬è©¦å…¥å£</li>
      </ul>

      <h6 class="fw-bold text-success">ğŸ’¬ çµè«–ï¼š</h6>
      <ul class="fw-bold" style="color:#e9ecef;">
        <li>âœ… <b>index.html</b> ç™»å…¥é ä¿ç•™å…§åµŒ JS æ˜¯æ­£ç¢ºè¨­è¨ˆã€‚</li>
        <li>âœ… <b>CloudFront</b> ç‚ºæ­£å¼ HTTPS é€šé“ï¼Œ<b>EC2</b> ç‚ºé–‹ç™¼æ¸¬è©¦é€šé“ã€‚</li>
        <li>âœ… ä¸éœ€æ‰“ <code>:5001</code>ï¼Œè©²åŸ ç‚ºå…§éƒ¨ç§æœ‰é€šè¨Šã€‚</li>
        <li>âœ… ç™»å…¥æˆåŠŸå¾Œè‡ªå‹•å°å‘ <code>/zh/Test/test.html</code>ï¼Œä¸¦ä¿å­˜ <code>api_key</code>ã€‚</li>
      </ul>
    </div>

    <p class="text-muted mt-5">ğŸ“… æ›´æ–°æ—¥æœŸï¼š2025-11-08</p>
  </main>

  <div id="footer"></div>
  <script src="/static/js/layout.js"></script>
  <script src="/static/js/api_basic.js"></script>
  <script src="/static/js/api_gunicorn.js"></script>
  <script src="/static/js/api_login.js"></script> <!-- âœ… æ–°å¢é€™è¡Œ -->

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const keyInput = document.getElementById("apiKeyInput");
    const keyDisplay = document.getElementById("currentKeyDisplay");
    const saveBtn = document.getElementById("saveKeyBtn");
    const clearBtn = document.getElementById("clearKeyBtn");

    // âœ… è‡ªå‹•è¼‰å…¥ç™»å…¥æ™‚å„²å­˜çš„ api_key
    const savedKey = localStorage.getItem("api_key");
    updateKeyDisplay(savedKey);

    if (savedKey) {
      const username = localStorage.getItem("username") || "ä½¿ç”¨è€…";
      console.log(`ğŸ” åµæ¸¬åˆ°ç™»å…¥é‡‘é‘°ï¼Œä½¿ç”¨è€…ï¼š${username}`);

      // âœ… é¡¯ç¤ºæ­¡è¿æç¤ºï¼ˆæ’å…¥ç›®å‰é‡‘é‘°ä¸‹æ–¹ï¼‰
      const welcomeNote = document.createElement("div");
      welcomeNote.innerHTML = `<b class="text-success">ğŸ‘‹ æ­¡è¿ ${username}ï¼ŒAPI é‡‘é‘°å·²è‡ªå‹•è¼‰å…¥ï¼</b>`;
      keyDisplay.parentElement.appendChild(welcomeNote);

      // è‡ªå‹•è§¸ç™¼ã€Œå„²å­˜é‡‘é‘°ã€æŒ‰éˆ•ï¼ˆä¿æŒåŒæ­¥é‚è¼¯ï¼‰
      setTimeout(() => saveBtn.click(), 300);
    }

    // âœ… å„²å­˜é‡‘é‘°
    saveBtn.addEventListener("click", (e) => {
      e.preventDefault();
      const key = keyInput.value.trim();
      const username = localStorage.getItem("username") || "ä½¿ç”¨è€…";
      if (!key) return showTempMessage("âš ï¸ è«‹è¼¸å…¥æœ‰æ•ˆçš„é‡‘é‘°ï¼", "danger");
      localStorage.setItem("api_key", key);
      updateKeyDisplay(key);
      showTempMessage(`âœ… API é‡‘é‘°å·²å„²å­˜ï¼ğŸ‘‹ Hello ${username}ï¼`, "success");
    });

    // âœ… æ¸…é™¤é‡‘é‘°
    clearBtn.addEventListener("click", (e) => {
      e.preventDefault();
      localStorage.removeItem("api_key");
      keyInput.value = "";
      updateKeyDisplay(null);
      showTempMessage("ğŸ§¹ API é‡‘é‘°å·²æ¸…é™¤ã€‚", "warning");
    });

    // ğŸ§© æ›´æ–°ç•«é¢é¡¯ç¤º
    function updateKeyDisplay(key) {
      if (key) {
        keyInput.value = key;
        keyDisplay.textContent = key;
        keyDisplay.classList.add("text-success");
      } else {
        keyDisplay.textContent = "ï¼ˆå°šæœªè¨­å®šï¼‰";
        keyDisplay.classList.remove("text-success");
      }
    }

    // ğŸ’¬ é¡¯ç¤ºæš«æ™‚æç¤ºè¨Šæ¯
    function showTempMessage(msg, type = "info") {
      const note = document.createElement("div");
      note.innerText = msg; // ç”¨ innerText æ‰èƒ½ä¿ç•™æ›è¡Œæ•ˆæœ (\n)
      note.className = `fw-bold text-${type} mt-2`;
      keyDisplay.parentElement.appendChild(note);
      setTimeout(() => note.remove(), 2500); // 2.5 ç§’å¾Œæ¶ˆå¤±
    }
  });
  </script>

</body>
</html>
