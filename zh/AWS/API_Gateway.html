<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>API Gateway ç­†è¨˜ï½œKAO-YU-HSIANG</title>

  <!-- å…±ç”¨æ¨£å¼ -->
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- å¤–éƒ¨å¥—ä»¶ -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
  <div id="header"></div>

  <main id="main" class="container">
    <div class="text-center mb-5">
      <h1>API Gateway ç­†è¨˜</h1>
      <p class="text-muted">
        æœ¬é æ•´ç† API Gateway çš„è³‡æºçµæ§‹ã€éšæ®µï¼ˆStageï¼‰ã€ç«¯é»æ ¼å¼ã€CORS èˆ‡æ¸¬è©¦æ–¹å¼ã€‚<br>
      </p>
    </div>

    <!-- ä¸€ã€è³‡æºçµæ§‹èˆ‡ç«¯é» -->
    <div class="section-title">ğŸ§© ä¸€ã€è³‡æºçµæ§‹èˆ‡ç«¯é»ï¼ˆResources & Stagesï¼‰</div>

    <p>
    ä»¥ä¸‹ç‚º API Gateway <code>hello-lambda-new-world</code> çš„å¯¦éš›çµæ§‹èˆ‡é‹è¡Œé€£çµï¼š<br>
    âœ… <a href="https://4b5cqz0xpd.execute-api.ap-northeast-1.amazonaws.com/Prod/hello" target="_blank">
    https://4b5cqz0xpd.execute-api.ap-northeast-1.amazonaws.com/Prod/hello</a>
    </p>

    <ul>
    <li><code>/</code>ï¼ˆæ ¹è·¯å¾‘ï¼‰</li>
    <li><code>/hello</code>ï¼š
        <ul>
        <li>æ–¹æ³•ï¼š<code>GET</code>ã€<code>OPTIONS</code></li>
        <li>æ•´åˆï¼šLambdaï¼ˆHelloWorldFunctionï¼‰</li>
        <li>Stageï¼š<code>Prod</code></li>
        </ul>
    </li>
    </ul>

    <p class="mt-3">
    API Gateway çš„ç«¯é»ï¼ˆEndpointï¼‰çµæ§‹å¦‚ä¸‹ï¼š
    </p>

    <pre><code>https://{api-id}.execute-api.{region}.amazonaws.com/{stage-name}/{path}</code></pre>

    <ul>
    <li><b>API IDï¼š</b>è‡ªå‹•ç”Ÿæˆï¼Œä¾‹å¦‚ <code>4b5cqz0xpd</code></li>
    <li><b>Regionï¼š</b>éƒ¨ç½²å€åŸŸï¼Œä¾‹å¦‚ <code>ap-northeast-1</code>ï¼ˆæ±äº¬ï¼‰</li>
    <li><b>Stageï¼š</b>ä»£è¡¨éƒ¨ç½²ç’°å¢ƒï¼Œä¾‹å¦‚ <code>Prod</code>ã€<code>Stage</code></li>
    <li><b>Pathï¼š</b>å¯¦éš›è·¯ç”±ï¼Œä¾‹å¦‚ <code>/hello</code></li>
    </ul>

    <div class="sub-block" 
        style="background: rgba(255,255,255,0.06); 
                border-left: 4px solid #00b4d8; 
                border-radius: 6px; 
                padding: 14px 18px;">
    <b style="color:#ffcc66;">ğŸ“˜ Stage èˆ‡ Prod çš„å·®åˆ¥ï¼š</b>
    <ul style="margin-top:8px; color:#e6e6e6; line-height:1.7;">
        <li><b style="color:#ffffff;">Stage</b>ï¼šé–‹ç™¼èˆ‡æ¸¬è©¦éšæ®µï¼ˆStagingï¼‰ï¼Œå¯éš¨æ™‚æ›´æ–°èˆ‡é™¤éŒ¯ã€‚</li>
        <li><b style="color:#ffffff;">Prod</b>ï¼šæ­£å¼ä¸Šç·šéšæ®µï¼ˆProductionï¼‰ï¼Œå°å¤–æä¾›ç©©å®šæœå‹™ã€‚</li>
        <li>ä½ å¯åœ¨åŒä¸€å€‹ API Gateway ä¸­å»ºç«‹å¤šå€‹ Stageï¼Œå°æ‡‰ä¸åŒéƒ¨ç½²ç‰ˆæœ¬ã€‚</li>
        <li><span style="color:#ff9999;">âš ï¸ è‹¥æœªé‡æ–°ã€Œéƒ¨ç½²ï¼ˆDeployï¼‰ã€è‡³ Stageï¼Œå¤–éƒ¨ç«¯é»ä¸æœƒæ›´æ–°ã€‚</span></li>
    </ul>
    </div>

    <p class="mt-3">
    å› æ­¤ï¼Œç›®å‰çš„æ­£å¼ç«¯é» <code>/Prod/hello</code> å³ä»£è¡¨è©² Lambda å·²æˆåŠŸéƒ¨ç½²æ–¼ã€ŒProd éšæ®µã€ï¼Œå¯ç›´æ¥è¢«å‰ç«¯ï¼ˆS3 ç¶²ç«™ï¼‰æˆ– <code>curl</code> æ¸¬è©¦å­˜å–ã€‚
    </p>

    <!-- äºŒã€éƒ¨ç½²èˆ‡æ›´æ–° -->
    <div class="section-title">â˜ï¸ äºŒã€éƒ¨ç½²èˆ‡æ›´æ–°ï¼ˆDeployï¼‰</div>
    <p>ä½¿ç”¨ SAM é€²è¡Œéƒ¨ç½²ï¼š</p>
    <pre><code>sam build
sam deploy --guided</code></pre>
    <p>è‹¥åƒ…åœ¨ API Gateway ä¸»æ§å°æ”¹å‹•è³‡æº/æ–¹æ³•ï¼Œéœ€ <b>éƒ¨ç½² API</b> åˆ°å°æ‡‰ Stage æ‰æœƒç”Ÿæ•ˆã€‚</p>

    <!-- ä¸‰ã€CORS -->
    <div class="section-title">ğŸ” ä¸‰ã€CORSï¼ˆè·¨ä¾†æºè³‡æºå…±ç”¨ï¼‰</div>
    <p>
      è‹¥å‰ç«¯ï¼ˆS3 ç¶²ç«™ï¼‰ä½¿ç”¨ <code>fetch()</code> å‘¼å« APIï¼Œéœ€ç¢ºä¿å›æ‡‰åŒ…å« CORS Headerã€‚<br>
      æ³¨æ„ï¼š<code>SAM &quot;Cors&quot;</code> åœ¨è‡ªå®šç¾© <code>RestApiId</code> æ™‚å¯èƒ½ä¸ç”Ÿæ•ˆï¼Œå»ºè­°æ–¼ Lambda ç›´æ¥å›å‚³ï¼š
    </p>
    <div class="code-wrap">
      <div class="code-title">Lambda å›å‚³ï¼ˆå« CORSï¼‰</div>
      <pre class="pretty-code"><code class="language-json">return {
  "statusCode": 200,
  "headers": {
    "Access-Control-Allow-Origin": "*",
    "Access-Control-Allow-Headers": "*",
    "Access-Control-Allow-Methods": "GET,POST,OPTIONS"
  },
  "body": json.dumps({"message": "hello world"})
}</code></pre>
    </div>

    <!-- å››ã€æ¸¬è©¦æ–¹æ³• -->
    <div class="section-title">ğŸ§ª å››ã€æ¸¬è©¦æ–¹å¼</div>
    <p><b>curl</b>ï¼š</p>
    <pre><code>curl -i "https://{api-id}.execute-api.ap-northeast-1.amazonaws.com/Prod/hello"</code></pre>

    <p><b>ç€è¦½å™¨ / fetch()</b>ï¼š</p>
    <pre><code>fetch("https://{api-id}.execute-api.ap-northeast-1.amazonaws.com/Prod/hello")
  .then(r =&gt; r.json())
  .then(console.log)</code></pre>

    <!-- äº”ã€è‡ªè¨‚ç¶²åŸŸï¼ˆå¯é¸ï¼‰ -->
    <div class="section-title">ğŸŒ äº”ã€è‡ªè¨‚ç¶²åŸŸï¼ˆé¸é…ï¼‰</div>
    <p>
      å¦‚éœ€ <b>HTTPS + è‡ªè¨‚ç¶²åŸŸ + å¿«å–</b>ï¼Œå»ºè­°ä½¿ç”¨ <b>CloudFront + ACM</b> ä»£ç†åˆ° API Gatewayï¼›<br>
      æä¾›ä¹¾æ·¨ç¶²å€ï¼ˆä¾‹å¦‚ <code>https://api.kao.life/hello</code>ï¼‰ä¸¦å¯æ§å¿«å–èˆ‡å®‰å…¨æ€§ã€‚
    </p>

    <p class="text-muted mt-4">ğŸ“… æ›´æ–°æ—¥æœŸï¼š2025-11-06</p>
  </main>

  <div id="footer"></div>
  <script src="/static/js/layout.js"></script>
</body>
</html>
