<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒ©ï¸ AWS EC2 é›²ç«¯ä¸»æ©Ÿç­†è¨˜ï½œKAO-YU-HSIANG</title>

  <!-- å…±ç”¨æ¨£å¼ -->
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
  <div id="header"></div>

  <main id="main" class="container">
    <div class="text-center mb-5">
      <h1>ğŸŒ©ï¸ AWS EC2 é›²ç«¯ä¸»æ©Ÿç­†è¨˜</h1>
      <p class="text-muted">
        æœ¬é ç°¡è¨˜ EC2 ä¸»æ©Ÿçš„å•Ÿå‹•æµç¨‹ã€è™›æ“¬ç’°å¢ƒè¨­å®šã€Flask API å•Ÿå‹•ã€èƒŒæ™¯å¸¸é§èˆ‡æ™‚å€ä¿®æ­£ã€‚
      </p>
    </div>

    <!-- ä¸€ã€EC2 åŸºæœ¬è³‡è¨Š -->
    <div class="section-title">ğŸ§© ä¸€ã€é€™å° EC2 çš„åŸºæœ¬è³‡è¨Š</div>
    <ul>
      <li>Instance IDï¼š<code>i-0bbc46ca9d34bb64e</code></li>
      <li>Public IPï¼š<code>18.176.60.86</code>ã€€/ã€€Private IPï¼š<code>172.31.42.6</code></li>
      <li>Regionï¼š<code>ap-northeast-1ï¼ˆæ±äº¬ï¼‰</code>ã€€AMIï¼š<code>Amazon Linux 2023</code>ã€€Typeï¼š<code>t2.micro</code></li>
      <li>Kernelï¼š<code>6.1.156-177.286.amzn2023.x86_64</code></li>
      <li>CPUï¼š<code>Intel(R) Xeon(R) E5-2686 v4 @ 2.30GHz</code></li>
      <li>Diskï¼š8 GBï¼ˆå¯ç”¨ç´„ 6.2 GBï¼‰</li>
    </ul>

    <!-- äºŒã€é‡‘é‘°èˆ‡ SSH -->
    <div class="section-title">ğŸ”‘ äºŒã€é‡‘é‘°èˆ‡ SSH ç™»å…¥</div>
    <pre><code>icacls "C:\Users\User\Documents\kao-ec2-key.pem" /inheritance:r
icacls "C:\Users\User\Documents\kao-ec2-key.pem" /grant:r "$($env:USERNAME):(R)"
ssh -i "C:\Users\User\Documents\kao-ec2-key.pem" ec2-user@18.176.60.86</code></pre>

    <!-- ä¸‰ã€Flask å°ˆæ¡ˆèˆ‡è™›æ“¬ç’°å¢ƒ -->
    <div class="section-title">ğŸ§° ä¸‰ã€Flask å°ˆæ¡ˆèˆ‡è™›æ“¬ç’°å¢ƒ</div>
    <pre><code>mkdir ~/kao_flask_api && cd ~/kao_flask_api
sudo dnf install python3 python3-pip -y
python3 -m venv venv && source venv/bin/activate
pip install flask flask-cors
</code></pre>
    <p>é€™å€‹è™›æ“¬ç’°å¢ƒ <code>venv</code> åƒ…å±¬æ–¼æ­¤è³‡æ–™å¤¾ï¼Œèˆ‡ç³»çµ±å…¨åŸŸ Python (<code>/usr/bin/python3</code>) ç„¡è¡çªã€‚</p>

    <!-- å››ã€app.py ç¯„ä¾‹ï¼ˆå« CORSï¼‰ -->
    <div class="section-title">ğŸ§  å››ã€app.py ç¯„ä¾‹ï¼ˆå« CORSï¼‰</div>
    <pre><code>from flask import Flask
from flask_cors import CORS

app = Flask(__name__)
CORS(app)  # å•Ÿç”¨è·¨ç¶²åŸŸè«‹æ±‚

@app.route("/")
def hello():
    return "Hello from EC2 Flask Server with CORS enabled!"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
</code></pre>
    <p>æ­¤ç‰ˆæœ¬å·²å¯è®“ S3 ç¶²é è·¨ç¶²åŸŸå‘¼å« APIï¼ˆè·¨ç¶²åŸŸ CORS å•é¡Œè§£æ±ºï¼‰ã€‚</p>

    <!-- äº”ã€Security Group é–‹æ”¾ 5000 -->
    <div class="section-title">ğŸŒ äº”ã€å®‰å…¨ç¾¤çµ„é–‹æ”¾ 5000 åŸ </div>
    <p>æ–¼ AWS ä¸»æ§å°çš„ <b>Security Groups â†’ launch-wizard-1 â†’ Inbound rules</b> æ–°å¢è¦å‰‡ï¼š</p>
    <table class="table table-sm">
      <thead><tr><th>Type</th><th>Protocol</th><th>Port</th><th>Source</th><th>Description</th></tr></thead>
      <tbody>
        <tr><td>Custom TCP</td><td>TCP</td><td>5000</td><td>0.0.0.0/0</td><td>Flask-API-Test</td></tr>
      </tbody>
    </table>
    <p>é–‹ç™¼éšæ®µå…¨é–‹æ”¾ç„¡å¦¨ï¼Œæ­£å¼ä¸Šç·šæ™‚å»ºè­°é™åˆ¶ä¾†æºã€‚</p>

    <!-- å…­ã€èƒŒæ™¯åŸ·è¡Œèˆ‡ Log -->
    <div class="section-title">âš™ï¸ å…­ã€èƒŒæ™¯åŸ·è¡Œèˆ‡ Log ç®¡ç†</div>
    <pre><code>cd ~/kao_flask_api
source venv/bin/activate
nohup python app.py > flask.log 2>&1 &
ps aux | grep app.py     # æª¢æŸ¥æ˜¯å¦åœ¨èƒŒæ™¯åŸ·è¡Œ
pkill -f app.py          # åœæ­¢æœå‹™
</code></pre>
    <p>ä½¿ç”¨ <code>nohup</code> å¯è®“æœå‹™åœ¨ç™»å‡ºå¾Œä»æŒçºŒé‹è¡Œã€‚Log æœƒå¯«å…¥ <code>flask.log</code>ã€‚</p>
    <details>
      <summary>ğŸ”¹ è£œå……ï¼šLog å‚™ä»½æŒ‡ä»¤èªªæ˜</summary>
      <pre><code>mv -f flask.log flask.log.bak 2>/dev/null || true</code></pre>
      <ul>
        <li>å°‡èˆŠçš„ <code>flask.log</code> æ”¹åç‚º <code>flask.log.bak</code>ã€‚</li>
        <li>è‹¥æª”æ¡ˆä¸å­˜åœ¨å‰‡å¿½ç•¥éŒ¯èª¤ï¼ˆä¸æœƒä¸­æ–·å¾ŒçºŒæµç¨‹ï¼‰ã€‚</li>
        <li>å¸¸ç”¨æ–¼é‡å•Ÿæœå‹™å‰ï¼Œç¢ºä¿æ–° Log ä¹¾æ·¨ã€‚</li>
      </ul>
    </details>

    <!-- ä¸ƒã€æ™‚å€è¨­å®šèˆ‡ Log æ™‚é–“ä¿®æ­£ -->
    <div class="section-title">ğŸ•“ ä¸ƒã€æ™‚å€è¨­å®šèˆ‡ Log æ™‚é–“ä¿®æ­£</div>
    <pre><code>timedatectl                     # æª¢æŸ¥ç›®å‰æ™‚å€
sudo timedatectl set-timezone Asia/Taipei
date                            # é©—è­‰é¡¯ç¤ºå°ç£æ™‚é–“ (CST, +0800)
pkill -f app.py                 # åœæ‰èˆŠæœå‹™
export TZ=Asia/Taipei           # é¡¯å¼æŒ‡å®šæ™‚å€
nohup python app.py > flask.log 2>&1 &
</code></pre>
    <p>EC2 é è¨­ä½¿ç”¨ UTCï¼Œæ¯”å°ç£æ…¢ 8 å°æ™‚ï¼›ä¿®æ”¹å¾Œéœ€é‡å•Ÿ Flask æ‰æœƒç”Ÿæ•ˆã€‚</p>

    <p class="text-muted mt-4">ğŸ“… æ›´æ–°æ—¥æœŸï¼š2025-11-07</p>
  </main>

  <div id="footer"></div>
  <script src="/static/js/layout.js"></script>
</body>
</html>
