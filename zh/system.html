<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AWS é›²ç«¯åŒæ­¥ç­†è¨˜ï½œKAO-YU-HSIANG</title>

  <!-- âœ… å…±ç”¨æ¨£å¼ -->
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- âœ… Bootstrap å¥—ä»¶ -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body>
  <!-- âœ… å…±ç”¨ Header -->
  <div id="header"></div>

  <main id="main" class="container">

    <div class="text-center mb-5">
      <h1>ç³»çµ±æ¶æ§‹èˆ‡ Lambda ç­†è¨˜ï½œKAO-YU-HSIANG</h1>
      <p class="text-muted">
        æœ¬é è¨˜éŒ„ KAO-YU-HSIANG åœ¨æœ¬åœ° VS Code é–‹ç™¼èˆ‡ AWS S3 åŒæ­¥æ¸¬è©¦çš„æµç¨‹èˆ‡ç‹€æ…‹ã€‚
      </p>
    </div>

    <div class="section-title">ğŸ¯ ç›®çš„</div>
    <p>åœ¨æœ¬åœ°ç«¯æ¨¡æ“¬ AWS Lambda + API Gateway çš„é‹ä½œï¼Œé–‹ç™¼èˆ‡æ¸¬è©¦å¾Œç«¯ APIï¼Œç¢ºèªåŠŸèƒ½æ­£ç¢ºå¾Œå†éƒ¨ç½²åˆ°é›²ç«¯ã€‚</p>

    <div class="section-title">ğŸ§© ä¸€ã€é–‹ç™¼ç›®æ¨™</div>
    <p>å»ºç«‹ä¸€å€‹ç°¡å–® APIï¼ˆä¾‹å¦‚ /helloï¼‰ï¼Œæ¥æ”¶è«‹æ±‚ä¸¦å›å‚³ï¼š</p>
    <pre><code>{"message": "hello world"}</code></pre>
    <p>é–‹ç™¼éšæ®µå…ˆåœ¨æœ¬åœ°åŸ·è¡Œï¼Œé¿å…é »ç¹éƒ¨ç½²é€ æˆè²»ç”¨æµªè²»ã€‚</p>

    <div class="section-title">ğŸ“˜ äºŒã€åŸºæœ¬æ¦‚å¿µ</div>
    <ul>
      <li><b>Lambdaï¼š</b> AWS æä¾›çš„äº‹ä»¶è§¸ç™¼é‹è¡Œç’°å¢ƒï¼Œä¸éœ€ç¶­è­·ä¼ºæœå™¨ã€‚</li>
      <li><b>API Gatewayï¼š</b> Lambda å°å¤–é–‹æ”¾çš„ HTTP å…¥å£ã€‚</li>
      <li><b>SAMï¼š</b> AWS Serverless Application Modelï¼Œå¯é€é Docker åœ¨æœ¬åœ°æ¨¡æ“¬ Lambda è¡Œç‚ºã€‚</li>
    </ul>

    <div class="section-title">ğŸ§± ä¸‰ã€æœ¬åœ°é–‹ç™¼æµç¨‹</div>
    <pre><code>sam init             # å»ºç«‹ç¯„ä¾‹å°ˆæ¡ˆï¼ˆé¸ Hello World / Python3.12ï¼‰
cd hello-lambda-new-world
sam build
sam local start-api --skip-pull-image
# æ¸¬è©¦ç¶²å€ï¼šhttp://127.0.0.1:3000/hello</code></pre>
    <p>é æœŸå›å‚³ï¼š<code>{"message": "hello world"}</code></p>

    <div class="section-title">â˜ï¸ å››ã€é›²ç«¯éƒ¨ç½²æµç¨‹</div>
    <pre><code>sam deploy --guided</code></pre>
    <ul>
      <li>Lambda Functionï¼ˆç¨‹å¼åŸ·è¡Œç’°å¢ƒï¼‰</li>
      <li>API Gatewayï¼ˆHTTP ä»‹é¢ï¼‰</li>
      <li>CloudFormation Stackï¼ˆè³‡æºç®¡ç†ï¼‰</li>
    </ul>
    <p>ç¯„ä¾‹é›²ç«¯æ¸¬è©¦ç¶²å€ï¼š</p>
    <code>https://xxxxx.execute-api.ap-northeast-1.amazonaws.com/Prod/hello</code>

    <div class="section-title">ğŸš¨ äº”ã€å¸¸è¦‹å•é¡Œ</div>
    <ul>
      <li><b>Missing Authentication Tokenï¼š</b> è·¯å¾‘éŒ¯èª¤ â†’ ä¿®æ­£ç‚º <code>/hello</code></li>
      <li><b>Binary validation failedï¼š</b> Python ç‰ˆæœ¬ä¸ç¬¦ â†’ ä¿®æ”¹ template.yaml â†’ <code>python3.12</code></li>
      <li><b>AccessDeniedï¼š</b> IAM æ¬Šé™ä¸è¶³ â†’ æª¢æŸ¥ AWS CLI è¨­å®šæˆ– IAM Policy</li>
    </ul>

    <div class="section-title">ğŸ”§ å…­ã€é‡é»æ‘˜è¦</div>
    <ul>
      <li><code>sam build</code>ï¼šå»ºæ§‹ä¾è³´</li>
      <li><code>sam local start-api</code>ï¼šå•Ÿå‹•æ¸¬è©¦ç’°å¢ƒ</li>
      <li><code>sam deploy</code>ï¼šé›²ç«¯ä½ˆç½²ä¸Šç·š</li>
      <li>Lambda æ˜¯çŸ­æš«ç’°å¢ƒï¼Œä¸éœ€ç¶­è­·ä¼ºæœå™¨</li>
    </ul>

    <div class="section-title">ğŸš€ ä¸ƒã€æ­£å¼éƒ¨ç½²å®Œæˆ</div>
    <p>åŸ·è¡Œ <code>sam deploy --guided</code> å¾Œï¼Œç³»çµ±æœƒå»ºç«‹ Lambda + API Gateway + IAM Roleã€‚</p>
    <pre><code>Successfully created/updated stack - hello-lambda-new-world in ap-northeast-1</code></pre>
    <p>æ­£å¼ç«¯é»ç¯„ä¾‹ï¼š</p>
    <code>https://xq1nikjgl5.execute-api.ap-northeast-1.amazonaws.com/Prod/hello</code>

    <div class="section-title">ğŸŒ— å…«ã€Stage / Prod å·®ç•°èªªæ˜</div>
    <p>API Gateway URL çµæ§‹ï¼š</p>
    <pre><code>https://{api-id}.execute-api.{region}.amazonaws.com/{stage-name}/{path}</code></pre>
    <ul>
      <li><b>Stageï¼š</b> æ¸¬è©¦éšæ®µï¼ˆé–‹ç™¼ç”¨ï¼‰</li>
      <li><b>Prodï¼š</b> æ­£å¼ä¸Šç·šç‰ˆæœ¬ï¼ˆSAM é è¨­ï¼‰</li>
    </ul>

    <div class="section-title">ğŸª„ ä¹ã€å°çµ</div>
    <p>ç›®å‰éƒ¨ç½²çµæœï¼š</p>
    <ul>
      <li>Lambda Functionï¼š<code>hello-lambda-new-world-HelloWorldFunction</code></li>
      <li>API Gateway URLï¼š<code>https://xq1nikjgl5.execute-api.ap-northeast-1.amazonaws.com/Prod/hello</code></li>
      <li>Regionï¼š<b>ap-northeast-1ï¼ˆæ±äº¬ï¼‰</b></li>
      <li>Stack åç¨±ï¼š<code>hello-lambda-new-world</code></li>
    </ul>

    <div class="section-title">ğŸŒ åã€CORS å•é¡Œèˆ‡è§£æ±ºç´€éŒ„ï¼ˆ2025/11/05ï¼‰</div>
    <p>åœ¨å‰ç«¯ï¼ˆS3 ç¶²ç«™ï¼‰ä»¥ fetch() å‘¼å« Lambda API æ™‚å‡ºç¾ï¼š</p>
    <pre><code>No 'Access-Control-Allow-Origin' header is present on the requested resource.</code></pre>

    <p><b>åŸå› ï¼š</b></p>
    <ol>
      <li>SAM çš„ <code>Cors:</code> å±¬æ€§åœ¨è‡ªå®šç¾© <code>RestApiId</code> æƒ…æ³ä¸‹ä¸æœƒç”Ÿæ•ˆã€‚</li>
      <li>API Gateway ä¸æœƒè‡ªå‹•é™„åŠ  CORS headerã€‚</li>
    </ol>

    <p><b>ä¿®æ­£æ–¹å¼ï¼š</b></p>
    <pre><code>return {
    "statusCode": 200,
    "headers": {
        "Access-Control-Allow-Origin": "*",
        "Access-Control-Allow-Headers": "*",
        "Access-Control-Allow-Methods": "GET,POST,OPTIONS"
    },
    "body": json.dumps({"message": "hello world"})
}</code></pre>

    <p><b>é©—è­‰çµæœï¼š</b> éƒ¨ç½²å¾Œ S3 é é¢å¯æˆåŠŸå‘¼å« APIï¼Œå›å‚³ï¼š</p>
    <pre><code>{"message": "hello world"}</code></pre>

  </main>

  <!-- âœ… å…±ç”¨ Footer -->
  <div id="footer"></div>

  <!-- âœ… å…±ç”¨ JS -->
  <script src="/static/js/layout.js"></script>
</body>
</html>
